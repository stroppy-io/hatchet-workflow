syntax = "proto3";

package database;

import "database/common.proto";
import "database/instance.proto";
import "database/postgres.proto";
import "validate/validate.proto";

option go_package = "github.com/stroppy-io/hatchet-workflow/internal/proto/database";

message Infra {
    Placement placement = 1 [(validate.rules).message.required = true];
    oneof infra {
        option (validate.required) = true;
        Postgres.Infra.Pgbouncer postgres = 2;
        Postgres.Infra.Patroni patroni = 3;
        Postgres.Infra.Etcd etcd = 4;
        Postgres.Infra.Backup backup = 5;
    }
}

message Cluster {
    Instance master = 1 [(validate.rules).message.required = true];
    repeated Instance replicas = 2;
    repeated Infra infra = 3;
}



